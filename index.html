<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø© - Ù…Ù†ØµØ© Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©">
    <meta name="keywords" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©, Ø®Ø¯Ù…Ø§Øª, Ù…Ø­Ù„Ø§Øª, Ø£Ø®Ø¨Ø§Ø±, Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">
    <meta name="author" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©">

    <!-- Cache Control -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Force Update -->
    <meta name="version" content="2.0.2">

    <title>Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø© - Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" id="metaAppTitle" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©">

    <!-- SEO Meta Tags (Dynamic) -->
    <meta name="description" id="metaDescription" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø© - Ù…Ù†ØµØ© Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©">
    <meta name="keywords" id="metaKeywords" content="Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©, Ø®Ø¯Ù…Ø§Øª, Ù…Ø­Ù„Ø§Øª, Ø£Ø®Ø¨Ø§Ø±, Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">

    <!-- Dynamic Styles -->
    <style id="dynamicStyles"></style>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/1000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ˜ï¸</text></svg>">
    <link rel="apple-touch-icon" href="images/icon.jpeg">

    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Version Check Script -->
    <script>
        // Check for version updates
        (function () {
            const currentVersion = '2.0.2';
            const storedVersion = localStorage.getItem('appVersion');
            const lastVersionCheck = localStorage.getItem('lastVersionCheck');
            const now = Date.now();

            // Force update if version changed or more than 1 day since last check
            if (storedVersion !== currentVersion || !lastVersionCheck || (now - parseInt(lastVersionCheck)) > 86400000) {
                console.log('Version check - forcing update');
                localStorage.setItem('appVersion', currentVersion);
                localStorage.setItem('lastVersionCheck', now.toString());

                // Clear all caches
                if ('caches' in window) {
                    caches.keys().then(function (names) {
                        names.forEach(function (name) {
                            caches.delete(name);
                        });
                    });
                }

                // Clear localStorage except essential data
                const keysToKeep = ['villageVisits', 'adminLoggedIn', 'adminUsername'];
                const allKeys = Object.keys(localStorage);
                allKeys.forEach(key => {
                    if (!keysToKeep.includes(key)) {
                        localStorage.removeItem(key);
                    }
                });

                // Force reload
                if (storedVersion && storedVersion !== currentVersion) {
                    window.location.reload(true);
                }
            }
        })();
    </script>
</head>

<body>
    <!-- Global Information Banner -->
    <div id="globalBanner" class="global-banner"
        style="display: none; background: #2563eb; color: white; padding: 10px 20px; text-align: center; position: sticky; top: 0; z-index: 2000; font-size: 0.95rem; font-weight: 500;">
        <div id="bannerText"></div>
    </div>

    <!-- Maintenance Overlay -->
    <div id="maintenanceOverlay" class="maintenance-overlay"
        style="display: none; position: fixed; inset: 0; background: white; z-index: 9999; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px;">
        <i class="fas fa-tools" style="font-size: 4rem; color: #ef4444; margin-bottom: 20px;"></i>
        <h1 id="maintenanceTitle" style="margin-bottom: 15px;">Ù†Ø­Ù† Ù†Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø­Ø§Ù„ÙŠØ§Ù‹</h1>
        <p id="maintenanceMessage" style="font-size: 1.2rem; color: #666; max-width: 500px;"></p>
        <div style="margin-top: 30px; font-size: 0.9rem; color: #999;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹ - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <i class="fas fa-mosque"></i>
            <h2>Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©</h2>
            <h3>ØµÙ„ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ</h3> <br>

            <div class="loading-bar"></div>
        </div>
    </div>

    <!-- Global Page Loading Indicator -->
    <div id="pageLoadingOverlay" class="page-loading-overlay" style="display: none;">
        <div class="page-loading-spinner">
            <div class="spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <a href="#" class="logo-link" onclick="navigateToPage('home'); return false;">
                    <i class="fas fa-mosque"></i>
                    <h1>Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©</h1>
                </a>
            </div>
            <div class="header-actions">
                <button id="backBtn" class="btn-icon" title="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" onclick="navigateToPage('home')">
                    <i class="fas fa-home"></i>
                </button>
                <button id="refreshBtn" class="btn-icon" title="ØªØ­Ø¯ÙŠØ«">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button id="menuBtn" class="btn-icon" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Navigation -->
    <nav class="main-nav" id="mainNav">
        <div class="nav-header">
            <h3>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
            <button id="closeNav" class="btn-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <ul class="nav-list">
            <li><a href="pages/craftsmen.html" class="nav-link" data-page="craftsmen">
                    <i class="fas fa-tools"></i>
                    <span>Ø§Ù„ØµÙ†Ø§ÙŠØ¹ÙŠØ© ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª</span>
                </a></li>
            <li><a href="pages/machines.html" class="nav-link" data-page="machines">
                    <i class="fas fa-tractor"></i>
                    <span>Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¢Ù„Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</span>
                </a></li>
            <li><a href="pages/shops.html" class="nav-link" data-page="shops">
                    <i class="fas fa-store"></i>
                    <span>Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</span>
                </a></li>
            <li><a href="pages/offers.html" class="nav-link" data-page="offers">
                    <i class="fas fa-tags"></i>
                    <span>Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„ØªØ®ÙÙŠØ¶Ø§Øª</span>
                </a></li>
            <li><a href="pages/ads.html" class="nav-link" data-page="ads">
                    <i class="fas fa-bullhorn"></i>
                    <span>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</span>
                </a></li>
            <li><a href="pages/emergency.html" class="nav-link" data-page="emergency">
                    <i class="fas fa-phone-alt"></i>
                    <span>Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</span>
                </a></li>
            <li><a href="pages/doctors.html" class="nav-link" data-page="doctors">
                    <i class="fas fa-user-md"></i>
                    <span>Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª</span>
                </a></li>
            <li><a href="pages/submit-service.html" class="nav-link" data-page="submit-service">
                    <i class="fas fa-file-alt"></i>
                    <span>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©</span>
                </a></li>
            <li><a href="pages/news.html" class="nav-link" data-page="news">
                    <i class="fas fa-newspaper"></i>
                    <span>Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</span>
                </a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page -->
        <div id="homePage" class="page home-page active">
            <!-- Full Width Banner Section -->
            <div id="homeFullBannerSection" style="display: none;">
                <div id="homeFullBanner" class="full-width-banner"></div>
            </div>

            <!-- Hero Section -->
            <section class="hero-section" data-component-name="<section />">
                <div class="hero-content" data-component-name="<div />">
                    <h2 data-component-name="<h2 />">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø©</h2>
                    <p data-component-name="<p />">Ù…Ù†ØµØªÙƒ Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ©</p>
                </div>
            </section>

            <!-- Village Info Section -->
            <section class="village-info">
                <div class="info-card">
                    <h3><i class="fas fa-info-circle"></i> Ù†Ø¨Ø°Ø© Ø¹Ù† Ù‚Ø±ÙŠØªÙ†Ø§</h3>
                    <p>Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø© Ù‡ÙŠ Ù‚Ø±ÙŠØ© Ù…ØµØ±ÙŠØ© ØªÙ‚Ø¹ ÙÙŠ Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø¨Ø­ÙŠØ±Ø©. ØªØ´ØªÙ‡Ø± Ø¨Ø§Ù„Ø²Ø±Ø§Ø¹Ø© ÙˆØ§Ù„Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø®Ù„Ø§Ø¨Ø©ØŒ ÙˆØªØªÙ…ÙŠØ² Ø¨Ø±ÙˆØ­
                        Ø§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„ØªÙƒØ§ØªÙ Ø¨ÙŠÙ† Ø£Ù‡Ù„Ù‡Ø§. ØªØ¶Ù… Ø§Ù„Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø±Ø§ÙÙ‚ Ø§Ù„ØªÙŠ ØªÙ„Ø¨ÙŠ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø³ÙƒØ§Ù†.</p>
                    <div class="village-stats">
                        <div class="stat-item">
                            <span class="stat-number">20,000+</span>
                            <span class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙƒØ§Ù†</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">200+</span>
                            <span class="stat-label">Ø®Ø¯Ù…Ø© Ù…ØªÙˆÙØ±Ø©</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">6,500+</span>
                            <span class="stat-label">ØµÙˆØª Ø§Ù†ØªØ®Ø§Ø¨ÙŠ</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">600+</span>
                            <span class="stat-label">Ø¹Ø§Ø¦Ù„Ø©</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Actions Grid -->
            <div class="actions-grid">
                <a href="pages/craftsmen.html" class="action-card" data-page="craftsmen">
                    <i class="fas fa-tools"></i>
                    <h3>Ø§Ù„ØµÙ†Ø§ÙŠØ¹ÙŠØ©</h3>
                    <p>Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø­Ø±Ù</p>
                </a>

                <a href="pages/shops.html" class="action-card" data-page="shops">
                    <i class="fas fa-store"></i>
                    <h3>Ø§Ù„Ù…Ø­Ù„Ø§Øª</h3>
                    <p>Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</p>
                </a>

                <a href="pages/doctors.html" class="action-card" data-page="doctors">
                    <i class="fas fa-user-md"></i>
                    <h3>Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª</h3>
                    <p>Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙˆØ§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª</p>
                </a>

                <a href="pages/submit-service.html" class="action-card" data-page="submit-service">
                    <i class="fas fa-file-alt"></i>
                    <h3>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©</h3>
                    <p>Ø£Ø¶Ù Ø®Ø¯Ù…ØªÙƒ</p>
                </a>

            </div>

            <style>
                .actions-grid {
                    grid-template-columns: repeat(3, 1fr) !important;
                    gap: 0.75rem !important;
                    max-width: 800px;
                    margin: 0 auto;
                    padding: 0.5rem;
                }

                .action-card {
                    min-height: auto !important;
                    padding: 0.75rem 0.5rem !important;
                    background: rgba(255, 255, 255, 0.8) !important;
                    backdrop-filter: blur(10px) !important;
                    border: 1px solid rgba(255, 255, 255, 0.3) !important;
                    border-radius: 12px !important;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05) !important;
                    transition: all 0.2s ease !important;
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: center !important;
                    justify-content: center !important;
                    text-align: center !important;
                    text-decoration: none !important;
                    color: var(--text-primary) !important;
                }

                .action-card:hover {
                    transform: translateY(-3px) !important;
                    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1) !important;
                    background: #fff !important;
                    border-color: var(--primary-color) !important;
                }

                .action-card i {
                    font-size: 1.25rem !important;
                    margin-bottom: 0.5rem !important;
                    color: var(--primary-color) !important;
                    background: var(--primary-light-rgba, rgba(30, 58, 138, 0.1));
                    width: 40px;
                    height: 40px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: 10px;
                }

                .action-card h3 {
                    font-size: 0.85rem !important;
                    font-weight: 600 !important;
                    margin: 0 !important;
                }

                .action-card p {
                    display: none !important;
                    /* Hide descriptions to save space */
                }

                @media (max-width: 480px) {
                    .actions-grid {
                        grid-template-columns: repeat(3, 1fr) !important;
                        gap: 0.5rem !important;
                    }

                    .action-card {
                        padding: 0.6rem 0.4rem !important;
                    }

                    .action-card i {
                        font-size: 1.1rem !important;
                        margin-bottom: 0.4rem !important;
                        width: 35px;
                        height: 35px;
                    }

                    .action-card h3 {
                        font-size: 0.75rem !important;
                    }
                }
            </style>

            <style>
                .home-ads-section {
                    margin: 1rem;
                    padding: 1rem;
                    background: var(--surface, #fff);
                    border-radius: 12px;
                    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
                }

                .home-ads-section h3 {
                    margin-bottom: 0.75rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .home-ads-container {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                    gap: 0.75rem;
                }

                .home-ad-card {
                    border: 1px solid var(--border-color, #e0e0e0);
                    border-radius: 12px;
                    padding: 0.9rem;
                    background: var(--surface-alt, #f8f9fa);
                }

                .home-ad-card h4 {
                    margin: 0 0 0.35rem 0;
                    font-size: 1rem;
                }

                .home-ad-card p {
                    margin: 0;
                    color: var(--text-secondary, #64748b);
                }

                .home-ad-actions {
                    margin-top: 0.75rem;
                    display: flex;
                    gap: 0.5rem;
                    flex-wrap: wrap;
                }

                .home-ad-actions a {
                    text-decoration: none;
                }

                .ad-highlighted {
                    border: 2px solid var(--primary-color, #2c3e50);
                    box-shadow: 0 4px 12px rgba(44, 62, 80, 0.15);
                }

                .ad-pulse {
                    animation: adPulse 2s infinite;
                }

                .ad-pulse.ad-animation-slow {
                    animation-duration: 3s;
                }

                .ad-pulse.ad-animation-fast {
                    animation-duration: 1s;
                }

                .ad-shake {
                    animation: adShake 0.5s ease-in-out infinite;
                }

                .ad-shake.ad-animation-slow {
                    animation-duration: 0.8s;
                }

                .ad-shake.ad-animation-fast {
                    animation-duration: 0.3s;
                }

                .ad-flash {
                    animation: adFlash 1.5s ease-in-out infinite;
                }

                .ad-flash.ad-animation-slow {
                    animation-duration: 2.5s;
                }

                .ad-flash.ad-animation-fast {
                    animation-duration: 1s;
                }

                .ad-bounce {
                    animation: adBounce 1s ease-in-out infinite;
                }

                .ad-bounce.ad-animation-slow {
                    animation-duration: 1.8s;
                }

                .ad-bounce.ad-animation-fast {
                    animation-duration: 0.6s;
                }

                .ad-glow {
                    animation: adGlow 2s ease-in-out infinite;
                }

                .ad-glow.ad-animation-slow {
                    animation-duration: 3s;
                }

                .ad-glow.ad-animation-fast {
                    animation-duration: 1.2s;
                }

                @keyframes adPulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.03); }
                }

                @keyframes adShake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-2px); }
                    75% { transform: translateX(2px); }
                }

                @keyframes adFlash {
                    0%, 100% { opacity: 1; }
                    50% { opacity: 0.6; }
                }

                @keyframes adBounce {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-4px); }
                }

                @keyframes adGlow {
                    0%, 100% { box-shadow: 0 0 5px rgba(44, 62, 80, 0.3); }
                    50% { box-shadow: 0 0 20px rgba(44, 62, 80, 0.6); }
                }

                .home-banner-ad {
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
                    color: white;
                    padding: 0.8rem 1.5rem;
                    border-radius: 8px;
                    margin: 0.5rem 0;
                    overflow: hidden;
                    position: relative;
                    box-shadow: 0 2px 8px rgba(44, 62, 80, 0.15);
                    white-space: nowrap;
                }

                .home-banner-ad-content {
                    display: inline-block;
                    padding-left: 100%;
                    animation: bannerScroll 18s linear infinite;
                }

                .home-banner-ad.ad-animation-slow .home-banner-ad-content {
                    animation-duration: 25s;
                }

                .home-banner-ad.ad-animation-fast .home-banner-ad-content {
                    animation-duration: 12s;
                }

                .home-banner-ad:hover .home-banner-ad-content {
                    animation-play-state: paused;
                }

                .home-banner-ad h4 {
                    display: inline;
                    margin: 0;
                    font-size: 1rem;
                    font-weight: 600;
                    margin-right: 1.5rem;
                }

                .home-banner-ad p {
                    display: inline;
                    margin: 0;
                    font-size: 0.9rem;
                    opacity: 0.9;
                }

                .home-banner-ad-actions {
                    display: inline;
                    margin-right: 1.5rem;
                }

                .home-banner-ad-actions a {
                    color: white;
                    text-decoration: none;
                    background: rgba(255, 255, 255, 0.2);
                    padding: 0.2rem 0.6rem;
                    border-radius: 3px;
                    margin: 0 0.3rem;
                    transition: background 0.3s ease;
                    font-size: 0.85rem;
                }

                .home-banner-ad-actions a:hover {
                    background: rgba(255, 255, 255, 0.3);
                }

                @keyframes bannerScroll {
                    0% {
                        transform: translateX(0);
                    }
                    100% {
                        transform: translateX(-100%);
                    }
                }
            </style>

            <!-- Latest News Section -->
            <section class="latest-news" onclick="window.location.href='pages/news.html'" style="cursor: pointer;">
                <h3><i class="fas fa-newspaper"></i> Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h3>
                <div id="latestNewsList">
                    <div class="news-item">
                        <h4>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±...</h4>
                        <div class="news-date">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                        <p>Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‡Ù†Ø§</p>
                    </div>
                </div>
                <div id="showMoreNews" class="show-more-news"
                    style="display: none; text-align: center; margin-top: 1rem;">
                    <a href="pages/news.html" class="btn btn-primary" data-page="news"
                        onclick="navigateToPage('news'); return false;">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</a>
                </div>
                <style>
                    .news-item {
                        display: flex;
                        gap: 1rem;
                        margin-bottom: 1rem;
                        padding: 1rem;
                        background: var(--surface, #fff);
                        border-radius: 8px;
                        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                    }

                    .news-image {
                        width: 120px;
                        height: 120px;
                        object-fit: cover;
                        border-radius: 8px;
                    }

                    .news-content {
                        flex: 1;
                    }

                    .news-author {
                        font-size: 0.8rem;
                        color: var(--text-muted, #6c757d);
                        margin-top: 0.25rem;
                    }

                    .show-more-news .btn {
                        padding: 0.75rem 1.5rem;
                        font-size: 1rem;
                    }
                </style>
            </section>

            <section class="home-ads-section" id="homeAdsMiddleSection" style="display: none;">
                <h3><i class="fas fa-bullhorn"></i> Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
                <div id="homeAdsMiddle" class="home-ads-container"></div>
            </section>

            <section class="home-ads-section" id="homeAdsBottomSection" style="display: none;">
                <h3><i class="fas fa-bullhorn"></i> Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
                <div id="homeAdsBottom" class="home-ads-container"></div>
            </section>
        </div>

        <!-- Other pages will be loaded dynamically -->
        <div id="pageContent"></div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2026 Ù‚Ø±ÙŠØ© Ø­Ø±Ø§Ø±Ø© - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
            <div class="footer-links">
                <a href="pages/admin.html" onclick="if(window.showLoadingOverlay) showLoadingOverlay();">Ù„ÙˆØ­Ø©
                    Ø§Ù„ØªØ­ÙƒÙ…</a>
                <a href="#" onclick="showSuggestionModal(); return false;" class="suggestion-btn">
                    <i class="fas fa-comment-dots"></i>
                    Ø§Ù‚ØªØ±Ø§Ø­ Ø£Ùˆ Ø´ÙƒÙˆÙ‰
                </a>
            </div>
        </div>
    </footer>

    <!-- Suggestion Modal -->
    <div id="suggestionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-comment-alt"></i>
                    ØªÙ‚Ø¯ÙŠÙ… Ø§Ù‚ØªØ±Ø§Ø­ Ø£Ùˆ Ø´ÙƒÙˆÙ‰
                </h3>
                <button class="modal-close" onclick="closeSuggestionModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="suggestionForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                        <input type="text" id="sugName" class="form-input" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                        <input type="tel" id="sugPhone" class="form-input" required placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ù„Ù„ØªÙˆØ§ØµÙ„">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</label>
                        <select id="sugType" class="form-select" required>
                            <option value="Ø§Ù‚ØªØ±Ø§Ø­">Ø§Ù‚ØªØ±Ø§Ø­</option>
                            <option value="Ø´ÙƒÙˆÙ‰">Ø´ÙƒÙˆÙ‰</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                        <textarea id="sugMessage" class="form-textarea" required
                            placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù‚ØªØ±Ø§Ø­Ùƒ Ø£Ùˆ Ø´ÙƒÙˆØ§Ùƒ Ù‡Ù†Ø§..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeSuggestionModal()">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-primary" id="sugSubmitBtn">
                        <i class="fas fa-paper-plane"></i>
                        <span>Ø¥Ø±Ø³Ø§Ù„</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="js/api-config-firebase.js"></script>
    <script type="module" src="js/script-firebase-fixed.js"></script>

    <script>
        // Track page visits
        document.addEventListener('DOMContentLoaded', function () {
            // Force cache refresh check
            forceCacheRefresh();

            trackVisit();
        });

        function trackVisit() {
            try {
                // Get current visit count from localStorage (for immediate feedback)
                let visits = JSON.parse(localStorage.getItem('villageVisits') || '{"total": 0, "monthly": {}, "yearly": {}}');

                // Increment total visits
                visits.total = (visits.total || 0) + 1;

                // Update monthly visits
                const now = new Date();
                const monthKey = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
                visits.monthly[monthKey] = (visits.monthly[monthKey] || 0) + 1;

                // Update yearly visits
                const yearKey = now.getFullYear().toString();
                visits.yearly[yearKey] = (visits.yearly[yearKey] || 0) + 1;

                // Save to localStorage
                localStorage.setItem('villageVisits', JSON.stringify(visits));

                // Save to Firebase central counter (for Admin Panel)
                const tryFirebaseTrack = () => {
                    if (window.firebaseClient && window.firebaseClient.incrementVisitCount) {
                        window.firebaseClient.incrementVisitCount()
                            .then(() => console.log('Visit tracked in Firebase central counter'))
                            .catch(err => console.error('Error tracking visit in Firebase:', err));
                        return true;
                    }
                    return false;
                };

                if (!tryFirebaseTrack()) {
                    // Try again every 500ms for up to 5 seconds if not ready
                    let attempts = 0;
                    const interval = setInterval(() => {
                        attempts++;
                        if (tryFirebaseTrack() || attempts > 10) {
                            clearInterval(interval);
                        }
                    }, 500);
                }

                console.log('Visit tracked successfully. Total visits:', visits.total);
            } catch (error) {
                console.error('Error tracking visit:', error);
            }
        }

        // Force cache refresh function
        function forceCacheRefresh() {
            console.log('Checking for cache refresh...');

            // Add random parameter to prevent caching
            const url = new URL(window.location.href);
            url.searchParams.set('v', Date.now());

            // Check if we need to force refresh
            const lastRefresh = localStorage.getItem('lastCacheRefresh');
            const now = Date.now();

            // Force refresh if more than 1 hour ago or first visit
            if (!lastRefresh || (now - parseInt(lastRefresh)) > 3600000) {
                console.log('Forcing cache refresh...');
                localStorage.setItem('lastCacheRefresh', now.toString());

                // Update version in meta
                const versionMeta = document.querySelector('meta[name="version"]');
                if (versionMeta) {
                    versionMeta.content = '2.0.1.' + now;
                }

                // Optional: Force reload if we detect old cache
                if (performance.navigation.type === 1) {
                    // Page is being reloaded, don't force again
                    return;
                }

                // Check if page is from cache
                if (performance.getEntriesByType) {
                    const entries = performance.getEntriesByType('navigation');
                    if (entries.length > 0) {
                        const navigation = entries[0];
                        if (navigation.transferSize === 0 && navigation.decodedBodySize === 0) {
                            console.log('Detected cached page, forcing refresh...');
                            // Only force refresh if it's been more than 30 minutes
                            if (!lastRefresh || (now - parseInt(lastRefresh)) > 1800000) {
                                window.location.reload(true);
                            }
                        }
                    }
                }
            }
        }

        // Add refresh button functionality
        document.addEventListener('DOMContentLoaded', function () {
            const refreshBtn = document.getElementById('refreshBtn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function () {
                    console.log('Manual refresh triggered');
                    localStorage.setItem('lastCacheRefresh', '0');
                    window.location.reload(true);
                });
            }

            // Apply System Settings
            applySettings();
        });

        async function applySettings() {
            try {
                // Wait for Firebase module to load if necessary
                const tryLoadSettings = async () => {
                    if (window.getData) {
                        const config = await window.getData('settings');
                        const siteConfig = config?.site_config;

                        if (siteConfig) {
                            console.log('Applying site settings...', siteConfig);

                            // 1. Site Identity & SEO
                            if (siteConfig.siteName) {
                                document.title = siteConfig.siteName + ' - ' + (siteConfig.siteSlogan || 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ©');
                                const logoText = document.querySelector('.logo h1');
                                if (logoText) logoText.textContent = siteConfig.siteName;
                                const loadingTitle = document.querySelector('.loading-content h2');
                                if (loadingTitle) loadingTitle.textContent = siteConfig.siteName;
                                document.getElementById('metaAppTitle')?.setAttribute('content', siteConfig.siteName);
                            }

                            if (siteConfig.siteSlogan) {
                                const heroTitle = document.querySelector('.hero-content h2');
                                if (heroTitle) heroTitle.textContent = 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ' + siteConfig.siteName;
                                const heroPara = document.querySelector('.hero-content p');
                                if (heroPara) heroPara.textContent = siteConfig.siteSlogan;
                            }

                            if (siteConfig.seoDescription) {
                                document.getElementById('metaDescription')?.setAttribute('content', siteConfig.seoDescription);
                            }
                            if (siteConfig.seoKeywords) {
                                document.getElementById('metaKeywords')?.setAttribute('content', siteConfig.seoKeywords);
                            }

                            // 2. Visual Customization
                            const root = document.documentElement;
                            if (siteConfig.primaryColor) {
                                root.style.setProperty('--primary-color', siteConfig.primaryColor);
                            }
                            if (siteConfig.accentColor) {
                                root.style.setProperty('--accent-color', siteConfig.accentColor);
                            }

                            // 3. Global Banner
                            const banner = document.getElementById('globalBanner');
                            if (siteConfig.bannerActive && siteConfig.bannerText) {
                                banner.style.display = 'block';
                                banner.style.background = siteConfig.bannerBg || '#2563eb';
                                document.getElementById('bannerText').textContent = siteConfig.bannerText;
                            } else {
                                banner.style.display = 'none';
                            }

                            // 4. Content Visibility (Navigation)
                            const navLinks = {
                                'doctors': siteConfig.showDoctors !== false,
                                'shops': siteConfig.showShops !== false,
                                'news': siteConfig.showNews !== false,
                                'ads': siteConfig.showAds !== false
                            };

                            for (const [page, visible] of Object.entries(navLinks)) {
                                const navItem = document.querySelector(`.nav-link[data-page="${page}"]`)?.parentElement;
                                const actionCard = document.querySelector(`.action-card[data-page="${page}"]`);
                                if (navItem) navItem.style.display = visible ? 'block' : 'none';
                                if (actionCard) actionCard.style.display = visible ? 'flex' : 'none';
                            }

                            // 5. Maintenance Mode
                            if (siteConfig.maintenanceMode) {
                                const overlay = document.getElementById('maintenanceOverlay');
                                if (overlay) {
                                    overlay.style.display = 'flex';
                                    document.getElementById('maintenanceMessage').textContent = siteConfig.maintenanceMessage || 'Ù†Ø­Ù† Ù†Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø­Ø§Ù„ÙŠØ§Ù‹...';
                                    document.body.style.overflow = 'hidden'; // Block scrolling
                                }
                            }

                            return true;
                        }
                    }
                    return false;
                };

                if (!await tryLoadSettings()) {
                    let attempts = 0;
                    const interval = setInterval(async () => {
                        attempts++;
                        if (await tryLoadSettings() || attempts > 15) {
                            clearInterval(interval);
                        }
                    }, 500);
                }

            } catch (error) {
                console.error('Error applying site settings:', error);
            }
        }
    </script>


</body>

</html>